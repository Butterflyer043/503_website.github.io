"0","state_df <- map_data(""state"")"
"0","state_df$RegionName <- state.abb[state_df$region]"
"0","state_df$RegionName <- c(state.abb,""DC"")[match(state_df$region,c(tolower(state.name),""district of columbia""))]"
"0","temp_df3=df %>% select(c(2,11,52,35,80))%>%"
"0","  rename( Listing.Price=MedianListingPricePerSqft_AllHomes,"
"0"," Rental.Price=MedianRentalPricePerSqft_AllHomes) %>%"
"0","   group_by(RegionName) %>% "
"0","  summarise_all(funs(mean), na.rm = TRUE)"
"0",""
"0","temp_df3$Listing.Price[as.numeric(temp_df3$Listing.Price)>300] = 300"
"0",""
"0","map_df=full_join(temp_df3,state_df,by=""RegionName"")"
"0",""
"0","centroids <- data.frame(region=tolower(state.name), long=state.center$x, lat=state.center$y)"
"0","centroids$abb<-state.abb[match(centroids$region,tolower(state.name))]"
"0","centroids = centroids[(centroids$abb != ""AK"") & (centroids$abb != ""HI"") & (centroids$abb != ""RI"") & (centroids$abb != ""DE""),]"
"0",""
"0",""
"0","p6=ggplot(data=map_df) +"
"0","  geom_polygon( aes(long, lat, group = group,fill = Listing.Price ), colour = ""white"") +"
"0","  scale_fill_viridis(option=""viridis"",alpha = 0.7, direction = -1, na.value = ""lightgrey"") + "
"0","      geom_text(data=centroids,aes(x = long, y=lat, label = abb),color=""black"",size=2)+"
"0","  coord_equal() +  cowplot::theme_map() +theme(legend.position = ""bottom"") +theme(legend.position = ""bottom"")"
"0",""
"0","p7=ggplot(data=map_df) +"
"0","  geom_polygon( aes(long, lat, group = group,fill = Rental.Price ), colour = ""white"") +"
"0","  scale_fill_viridis(option=""inferno"",alpha = 0.7, direction = -1, na.value = ""lightgrey"") + "
"0","      geom_text(data=centroids,aes(x = long, y=lat, label = abb),color=""black"",size=2)+"
"0","  coord_equal() +  cowplot::theme_map() +theme(legend.position = ""bottom"") +theme(legend.position = ""bottom"")"
"0",""
